# Default plots for the SEIRD model
---
# --- Plot of all densities over time -----------------------------------------
densities:
  based_on: densities


# --- Distribution plots ------------------------------------------------------
age_distribution/final:
  based_on: [age_distribution, style.prop_cycle.seird]
  transform:
    - SEIRD.compute_age_distribution:
        age: !dag_tag age
        kind: !dag_tag kind
        coarsen_by: 10
    # Select the last time step
    - .isel: [!dag_prev , {time: -1}]
      tag: counts

  helpers:
    set_title:
      title: Final Age Distribution


age_distribution/time_series:
  based_on: [age_distribution, style.prop_cycle.seird, .animation.ffmpeg]
  transform:
    - SEIRD.compute_age_distribution:
        age: !dag_tag age
        kind: !dag_tag kind
        coarsen_by: 10
        normalize: false  # optional. Default: false
      tag: counts

  # Represent the time dimension as frames of the animation
  frames: time


age_distribution/deceased:
  based_on: [age_distribution, style.prop_cycle.deceased]
  transform:
    - SEIRD.compute_age_distribution:
        age: !dag_tag age
        kind: !dag_tag kind
        coarsen_by: 10
        compute_for_kinds: [deceased]
    - .sum: [!dag_prev , time]
    - print: !dag_prev
      tag: counts

  helpers:
    set_title:
      title: Deceased Age Distribution


# --- Phase diagrams from two densities ---------------------------------------
phase_diagram/SI:
  based_on: phase_diagram

  # Select from which densities to create the phase diagram
  x: susceptible
  y: infected

  helpers:
    set_labels:
      x: Susceptible Density [1/A]
      y: Infected Density [1/A]

phase_diagram/SE:
  based_on: phase_diagram

  x: susceptible
  y: exposed

  helpers:
    set_labels:
      x: Susceptible Density [1/A]
      y: Exposed Density [1/A]

phase_diagram/EI:
  based_on: phase_diagram

  x: exposed
  y: infected

  helpers:
    set_labels:
      x: Exposed Density [1/A]
      y: Infected Density [1/A]


# --- Snapshots and animations of the spatial grid ----------------------------
# NOTE These are both based on the snapshot base plots and add the remaining
#      parameters: For snapshots, the time index that is to be plotted; for
#      animations, the animation parameters (using multiple inheritance).

# ... The CA ..............................................................
CA_snapshot:
  based_on: CA_snapshot
  enabled: false
  time_idx: -1

CA:
  based_on: [CA_snapshot, .ca.state.anim_ffmpeg]


# ... The CA age ..........................................................
CA_age_snapshot:
  based_on: CA_age_snapshot
  enabled: false
  time_idx: -1

CA_age:
  based_on: [CA_age_snapshot, .ca.state.anim_ffmpeg]


# ... The clusters ............................................................
clusters_snapshot:
  based_on: clusters_snapshot
  enabled: false
  time_idx: -1

clusters:
  based_on: [clusters_snapshot, .ca.state.anim_ffmpeg]


# --- Miscellaneous -----------------------------------------------------------
# ... Combined plot of CA states and clusters .............................
CA_and_clusters:
  based_on: [CA_snapshot, clusters_snapshot, .ca.state.anim_ffmpeg]
  enabled: false
